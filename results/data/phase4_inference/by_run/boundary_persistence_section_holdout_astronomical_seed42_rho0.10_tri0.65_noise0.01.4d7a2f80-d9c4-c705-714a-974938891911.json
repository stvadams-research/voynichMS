{
  "provenance": {
    "run_id": "4d7a2f80-d9c4-c705-714a-974938891911",
    "git_commit": "204d1a9eb4a4e5cde1844826deaf6d0032ec662d",
    "timestamp": "2026-02-18T04:29:16.452973+00:00",
    "seed": 1771388956452,
    "experiment_id": "38e532f7-f5b2-4a91-b95b-ae82c768f595",
    "run_nonce": 1771388956452911000,
    "command": "run_boundary_persistence_section_holdout_check_phase4"
  },
  "results": {
    "status": "ok",
    "config": {
      "sections": [
        "astronomical"
      ],
      "min_holdout_folios": 4,
      "random_state": 42
    },
    "generator_params": {
      "markov": {
        "random_state": 42
      },
      "backoff": {
        "random_state": 42,
        "trigram_use_prob": 0.55,
        "unigram_noise_prob": 0.03
      },
      "persistence": {
        "random_state": 42,
        "trigram_use_prob": 0.65,
        "unigram_noise_prob": 0.01,
        "boundary_persistence_rho": 0.1
      }
    },
    "persistence_section_overrides": {},
    "section_results": {
      "astronomical": {
        "split": {
          "section": "astronomical",
          "train_folios": [
            "f2v",
            "f3r",
            "f3v",
            "f4r",
            "f4v",
            "f5r",
            "f5v",
            "f6r",
            "f6v",
            "f7r",
            "f7v",
            "f8r",
            "f8v",
            "f9r",
            "f9v",
            "f10r",
            "f10v",
            "f11r",
            "f11v",
            "f13r",
            "f13v",
            "f14r",
            "f14v",
            "f15r",
            "f15v",
            "f16r",
            "f16v",
            "f17r",
            "f17v",
            "f18r",
            "f18v",
            "f19r",
            "f19v",
            "f20r",
            "f20v",
            "f21r",
            "f21v",
            "f22r",
            "f22v",
            "f23r",
            "f23v",
            "f24r",
            "f24v",
            "f25r",
            "f25v",
            "f26r",
            "f26v",
            "f27r",
            "f27v",
            "f28r",
            "f28v",
            "f29r",
            "f29v",
            "f30r",
            "f30v",
            "f31r",
            "f31v",
            "f32r",
            "f32v",
            "f33r",
            "f33v",
            "f34r",
            "f34v",
            "f35r",
            "f35v",
            "f36r",
            "f36v",
            "f37r",
            "f37v",
            "f38r",
            "f38v",
            "f39r",
            "f39v",
            "f40r",
            "f40v",
            "f41r",
            "f41v",
            "f42r",
            "f42v",
            "f43r",
            "f43v",
            "f44r",
            "f44v",
            "f45r",
            "f45v",
            "f46r",
            "f46v",
            "f47r",
            "f47v",
            "f48r",
            "f48v",
            "f49r",
            "f49v",
            "f50r",
            "f50v",
            "f51r",
            "f51v",
            "f52r",
            "f52v",
            "f53r",
            "f53v",
            "f54r",
            "f54v",
            "f55r",
            "f55v",
            "f56r",
            "f56v",
            "f57r",
            "f57v",
            "f58r",
            "f58v",
            "f65r",
            "f65v",
            "f66r",
            "f66v",
            "f75r",
            "f75v",
            "f76r",
            "f76v",
            "f77r",
            "f77v",
            "f78r",
            "f78v",
            "f79r",
            "f79v",
            "f80r",
            "f80v",
            "f81r",
            "f81v",
            "f82r",
            "f82v",
            "f83r",
            "f83v",
            "f84r",
            "f84v",
            "f85r1",
            "f85r2",
            "f86v3",
            "f86v4",
            "f86v5",
            "f86v6",
            "f87r",
            "f87v",
            "f88r",
            "f88v",
            "f89r1",
            "f89r2",
            "f89v1",
            "f89v2",
            "f90r1",
            "f90r2",
            "f90v1",
            "f90v2",
            "f93r",
            "f93v",
            "f94r",
            "f94v",
            "f95r1",
            "f95r2",
            "f95v1",
            "f95v2",
            "f96r",
            "f96v",
            "f99r",
            "f99v",
            "f100v",
            "f101r",
            "f101v",
            "f102r1",
            "f102r2",
            "f102v1",
            "f102v2",
            "f103r",
            "f103v",
            "f104r",
            "f104v",
            "f105r",
            "f105v",
            "f106r",
            "f106v",
            "f107r",
            "f107v",
            "f108r",
            "f108v",
            "f111r",
            "f111v",
            "f112r",
            "f112v",
            "f113r",
            "f113v",
            "f114r",
            "f114v",
            "f115r",
            "f115v",
            "f116r",
            "f116v"
          ],
          "holdout_folios": [
            "f67r1",
            "f67r2",
            "f67v1",
            "f67v2",
            "f68r1",
            "f68r2",
            "f68r3",
            "f68v1",
            "f68v2",
            "f68v3",
            "f69r",
            "f69v",
            "f70r1",
            "f70r2",
            "f70v1",
            "f70v2",
            "f71r",
            "f71v",
            "f72r1",
            "f72r2",
            "f72r3",
            "f72v1",
            "f72v2",
            "f72v3",
            "f73r",
            "f73v"
          ],
          "train_line_count": 97316,
          "holdout_line_count": 5687,
          "holdout_token_count": 15174
        },
        "effective_persistence_params": {
          "boundary_persistence_rho": 0.1,
          "trigram_use_prob": 0.65,
          "unigram_noise_prob": 0.01
        },
        "metrics": {
          "order_l1_gap": {
            "line_reset_markov_trainfit": 1.0005106294277324,
            "line_reset_backoff_trainfit": 0.8904615230838078,
            "line_reset_persistence_trainfit": 0.887488118510257
          },
          "order_h3_gap": {
            "line_reset_markov_trainfit": 0.3914508807807775,
            "line_reset_backoff_trainfit": 0.3446851950813765,
            "line_reset_persistence_trainfit": 0.3311809121497733
          },
          "discrimination_distance": {
            "line_reset_markov_trainfit": 0.4927322220613557,
            "line_reset_backoff_trainfit": 0.4866576145619306,
            "line_reset_persistence_trainfit": 0.48493690366559583
          },
          "ncd_point": {
            "line_reset_markov_trainfit": 0.9884820167336738,
            "line_reset_backoff_trainfit": 0.9886696406579272,
            "line_reset_persistence_trainfit": 0.9884741892516378
          },
          "ncd_p_closest": {
            "line_reset_markov_trainfit": 0.4,
            "line_reset_backoff_trainfit": 0.3,
            "line_reset_persistence_trainfit": 0.3
          }
        },
        "winners": {
          "order_l1": "line_reset_persistence_trainfit",
          "discrimination": "line_reset_persistence_trainfit",
          "ncd_point": "line_reset_persistence_trainfit",
          "ncd_prob": "line_reset_markov_trainfit"
        },
        "order_holdout_gaps_ranked": [
          {
            "dataset_id": "line_reset_persistence_trainfit",
            "h2_gap": 0.2781903388149143,
            "h3_gap": 0.3311809121497733,
            "mi2_gap": 0.2781168675455694,
            "order_l1_gap": 0.887488118510257
          },
          {
            "dataset_id": "line_reset_backoff_trainfit",
            "h2_gap": 0.2729576657090824,
            "h3_gap": 0.3446851950813765,
            "mi2_gap": 0.27281866229334883,
            "order_l1_gap": 0.8904615230838078
          },
          {
            "dataset_id": "line_reset_markov_trainfit",
            "h2_gap": 0.30418206086324684,
            "h3_gap": 0.3914508807807775,
            "mi2_gap": 0.30487768778370805,
            "order_l1_gap": 1.0005106294277324
          }
        ],
        "discrimination": {
          "status": "ok",
          "config": {
            "window_size": 72,
            "windows_per_dataset": 160,
            "max_features": 2000,
            "ngram_min": 1,
            "ngram_max": 2,
            "train_fraction": 0.7,
            "random_state": 42,
            "voynich_dataset_id": "voynich_holdout"
          },
          "doc_counts": {
            "voynich_holdout": 160,
            "line_reset_markov_trainfit": 160,
            "line_reset_backoff_trainfit": 160,
            "line_reset_persistence_trainfit": 160
          },
          "n_docs": 640,
          "n_features": 2000,
          "n_train": 448,
          "n_test": 192,
          "classes": [
            "line_reset_backoff_trainfit",
            "line_reset_markov_trainfit",
            "line_reset_persistence_trainfit",
            "voynich_holdout"
          ],
          "models": {
            "nearest_centroid": {
              "accuracy": 0.46875,
              "confusion_counts": {
                "line_reset_backoff_trainfit": {
                  "line_reset_backoff_trainfit": 16,
                  "line_reset_markov_trainfit": 18,
                  "line_reset_persistence_trainfit": 14,
                  "voynich_holdout": 0
                },
                "line_reset_markov_trainfit": {
                  "line_reset_backoff_trainfit": 19,
                  "line_reset_markov_trainfit": 13,
                  "line_reset_persistence_trainfit": 16,
                  "voynich_holdout": 0
                },
                "line_reset_persistence_trainfit": {
                  "line_reset_backoff_trainfit": 17,
                  "line_reset_markov_trainfit": 16,
                  "line_reset_persistence_trainfit": 15,
                  "voynich_holdout": 0
                },
                "voynich_holdout": {
                  "line_reset_backoff_trainfit": 2,
                  "line_reset_markov_trainfit": 0,
                  "line_reset_persistence_trainfit": 0,
                  "voynich_holdout": 46
                }
              },
              "confusion_row_normalized": {
                "line_reset_backoff_trainfit": {
                  "line_reset_backoff_trainfit": 0.3333333333333333,
                  "line_reset_markov_trainfit": 0.375,
                  "line_reset_persistence_trainfit": 0.2916666666666667,
                  "voynich_holdout": 0.0
                },
                "line_reset_markov_trainfit": {
                  "line_reset_backoff_trainfit": 0.3958333333333333,
                  "line_reset_markov_trainfit": 0.2708333333333333,
                  "line_reset_persistence_trainfit": 0.3333333333333333,
                  "voynich_holdout": 0.0
                },
                "line_reset_persistence_trainfit": {
                  "line_reset_backoff_trainfit": 0.3541666666666667,
                  "line_reset_markov_trainfit": 0.3333333333333333,
                  "line_reset_persistence_trainfit": 0.3125,
                  "voynich_holdout": 0.0
                },
                "voynich_holdout": {
                  "line_reset_backoff_trainfit": 0.041666666666666664,
                  "line_reset_markov_trainfit": 0.0,
                  "line_reset_persistence_trainfit": 0.0,
                  "voynich_holdout": 0.9583333333333334
                }
              }
            },
            "knn_1_cosine": {
              "accuracy": 0.4010416666666667,
              "confusion_counts": {
                "line_reset_backoff_trainfit": {
                  "line_reset_backoff_trainfit": 12,
                  "line_reset_markov_trainfit": 18,
                  "line_reset_persistence_trainfit": 18,
                  "voynich_holdout": 0
                },
                "line_reset_markov_trainfit": {
                  "line_reset_backoff_trainfit": 17,
                  "line_reset_markov_trainfit": 11,
                  "line_reset_persistence_trainfit": 20,
                  "voynich_holdout": 0
                },
                "line_reset_persistence_trainfit": {
                  "line_reset_backoff_trainfit": 23,
                  "line_reset_markov_trainfit": 16,
                  "line_reset_persistence_trainfit": 7,
                  "voynich_holdout": 2
                },
                "voynich_holdout": {
                  "line_reset_backoff_trainfit": 1,
                  "line_reset_markov_trainfit": 0,
                  "line_reset_persistence_trainfit": 0,
                  "voynich_holdout": 47
                }
              },
              "confusion_row_normalized": {
                "line_reset_backoff_trainfit": {
                  "line_reset_backoff_trainfit": 0.25,
                  "line_reset_markov_trainfit": 0.375,
                  "line_reset_persistence_trainfit": 0.375,
                  "voynich_holdout": 0.0
                },
                "line_reset_markov_trainfit": {
                  "line_reset_backoff_trainfit": 0.3541666666666667,
                  "line_reset_markov_trainfit": 0.22916666666666666,
                  "line_reset_persistence_trainfit": 0.4166666666666667,
                  "voynich_holdout": 0.0
                },
                "line_reset_persistence_trainfit": {
                  "line_reset_backoff_trainfit": 0.4791666666666667,
                  "line_reset_markov_trainfit": 0.3333333333333333,
                  "line_reset_persistence_trainfit": 0.14583333333333334,
                  "voynich_holdout": 0.041666666666666664
                },
                "voynich_holdout": {
                  "line_reset_backoff_trainfit": 0.020833333333333332,
                  "line_reset_markov_trainfit": 0.0,
                  "line_reset_persistence_trainfit": 0.0,
                  "voynich_holdout": 0.9791666666666666
                }
              }
            }
          },
          "centroid_cosine_distance": {
            "line_reset_backoff_trainfit": {
              "line_reset_backoff_trainfit": -4.440892098500626e-16,
              "line_reset_markov_trainfit": 0.09882937837872507,
              "line_reset_persistence_trainfit": 0.10344011653049356,
              "voynich_holdout": 0.4866576145619306
            },
            "line_reset_markov_trainfit": {
              "line_reset_backoff_trainfit": 0.09882937837872507,
              "line_reset_markov_trainfit": 4.440892098500626e-16,
              "line_reset_persistence_trainfit": 0.09526647202728566,
              "voynich_holdout": 0.4927322220613557
            },
            "line_reset_persistence_trainfit": {
              "line_reset_backoff_trainfit": 0.10344011653049356,
              "line_reset_markov_trainfit": 0.09526647202728566,
              "line_reset_persistence_trainfit": 3.3306690738754696e-16,
              "voynich_holdout": 0.48493690366559583
            },
            "voynich_holdout": {
              "line_reset_backoff_trainfit": 0.4866576145619306,
              "line_reset_markov_trainfit": 0.4927322220613557,
              "line_reset_persistence_trainfit": 0.48493690366559583,
              "voynich_holdout": 2.220446049250313e-16
            }
          },
          "voynich_summary": {
            "status": "ok",
            "voynich_dataset_id": "voynich_holdout",
            "closest_centroids": [
              {
                "dataset_id": "line_reset_persistence_trainfit",
                "cosine_distance": 0.48493690366559583
              },
              {
                "dataset_id": "line_reset_backoff_trainfit",
                "cosine_distance": 0.4866576145619306
              },
              {
                "dataset_id": "line_reset_markov_trainfit",
                "cosine_distance": 0.4927322220613557
              }
            ],
            "voynich_test_assignment_nearest_centroid": {
              "line_reset_backoff_trainfit": 0.041666666666666664,
              "line_reset_markov_trainfit": 0.0,
              "line_reset_persistence_trainfit": 0.0,
              "voynich_holdout": 0.9583333333333334
            },
            "voynich_test_assignment_knn_1": {
              "line_reset_backoff_trainfit": 0.020833333333333332,
              "line_reset_markov_trainfit": 0.0,
              "line_reset_persistence_trainfit": 0.0,
              "voynich_holdout": 0.9791666666666666
            }
          }
        },
        "ncd": {
          "status": "ok",
          "config": {
            "token_limit": 80000,
            "bootstraps": 10,
            "block_size": 512,
            "random_state": 42,
            "focus_dataset_id": "voynich_holdout"
          },
          "dataset_ids": [
            "voynich_holdout",
            "line_reset_markov_trainfit",
            "line_reset_backoff_trainfit",
            "line_reset_persistence_trainfit"
          ],
          "point_estimate_ncd": {
            "voynich_holdout": {
              "voynich_holdout": 0.0,
              "line_reset_markov_trainfit": 0.9884820167336738,
              "line_reset_backoff_trainfit": 0.9886696406579272,
              "line_reset_persistence_trainfit": 0.9884741892516378
            },
            "line_reset_markov_trainfit": {
              "voynich_holdout": 0.9884820167336738,
              "line_reset_markov_trainfit": 0.0,
              "line_reset_backoff_trainfit": 0.9700912745843746,
              "line_reset_persistence_trainfit": 0.9696566337064001
            },
            "line_reset_backoff_trainfit": {
              "voynich_holdout": 0.9886696406579272,
              "line_reset_markov_trainfit": 0.9700912745843746,
              "line_reset_backoff_trainfit": 0.0,
              "line_reset_persistence_trainfit": 0.9702068665561203
            },
            "line_reset_persistence_trainfit": {
              "voynich_holdout": 0.9884741892516378,
              "line_reset_markov_trainfit": 0.9696566337064001,
              "line_reset_backoff_trainfit": 0.9702068665561203,
              "line_reset_persistence_trainfit": 0.0
            }
          },
          "point_compressed_sizes": {
            "voynich_holdout": 29920,
            "line_reset_markov_trainfit": 36812,
            "line_reset_backoff_trainfit": 36539,
            "line_reset_persistence_trainfit": 36787
          },
          "focus_dataset_id": "voynich_holdout",
          "focus_bootstrap_summary": {
            "line_reset_markov_trainfit": {
              "point_ncd": 0.9884820167336738,
              "bootstrap_mean_ncd": 0.9969073259069237,
              "bootstrap_ci95_low_ncd": 0.9963531049041278,
              "bootstrap_ci95_high_ncd": 0.997409869831714,
              "closest_probability": 0.4,
              "rank_mean": 2.0,
              "rank_ci95_low": 1.0,
              "rank_ci95_high": 3.0
            },
            "line_reset_backoff_trainfit": {
              "point_ncd": 0.9886696406579272,
              "bootstrap_mean_ncd": 0.9969014650428406,
              "bootstrap_ci95_low_ncd": 0.9962647678267877,
              "bootstrap_ci95_high_ncd": 0.9976474048398501,
              "closest_probability": 0.3,
              "rank_mean": 2.3,
              "rank_ci95_low": 1.0,
              "rank_ci95_high": 3.0
            },
            "line_reset_persistence_trainfit": {
              "point_ncd": 0.9884741892516378,
              "bootstrap_mean_ncd": 0.9968352547208073,
              "bootstrap_ci95_low_ncd": 0.9963467608223489,
              "bootstrap_ci95_high_ncd": 0.99751498076994,
              "closest_probability": 0.3,
              "rank_mean": 1.7,
              "rank_ci95_low": 1.0,
              "rank_ci95_high": 2.0
            }
          }
        }
      }
    },
    "summary": {
      "num_sections_evaluated": 1,
      "model_metric_means": {
        "line_reset_markov_trainfit": {
          "order_l1_gap": 1.0005106294277324,
          "order_h3_gap": 0.3914508807807775,
          "discrimination_distance": 0.4927322220613557,
          "ncd_point": 0.9884820167336738,
          "ncd_p_closest": 0.4
        },
        "line_reset_backoff_trainfit": {
          "order_l1_gap": 0.8904615230838078,
          "order_h3_gap": 0.3446851950813765,
          "discrimination_distance": 0.4866576145619306,
          "ncd_point": 0.9886696406579272,
          "ncd_p_closest": 0.3
        },
        "line_reset_persistence_trainfit": {
          "order_l1_gap": 0.887488118510257,
          "order_h3_gap": 0.3311809121497733,
          "discrimination_distance": 0.48493690366559583,
          "ncd_point": 0.9884741892516378,
          "ncd_p_closest": 0.3
        }
      },
      "winner_counts": {
        "order_l1": {
          "line_reset_persistence_trainfit": 1
        },
        "discrimination": {
          "line_reset_persistence_trainfit": 1
        },
        "ncd_point": {
          "line_reset_persistence_trainfit": 1
        },
        "ncd_prob": {
          "line_reset_markov_trainfit": 1
        }
      }
    },
    "skipped_sections": {}
  }
}