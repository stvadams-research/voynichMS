<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Voynich Tool Workbench</title>
  <link rel="stylesheet" href="css/app.css">
</head>
<body>
  <header class="app-header">
    <div>
      <h1>Voynich Tool Workbench</h1>
      <p>Standalone offline toolkit for slips, lattice, IVTFF validation, and synthetic generation.</p>
    </div>
  </header>

  <nav class="app-nav" id="app-nav">
    <button class="nav-btn active" data-route="slips">Slips</button>
    <button class="nav-btn" data-route="lattice">Lattice</button>
    <button class="nav-btn" data-route="validator">IVTFF Validator</button>
    <button class="nav-btn" data-route="folio">Folio Generator</button>
    <button class="nav-btn" data-route="page" title="Planned capability">Page Generator (Planned)</button>
  </nav>

  <main class="app-main">
    <section class="view active" id="view-slips">
      <div class="two-col">
        <div class="panel">
          <h2>Mechanical Slips</h2>
          <p class="muted" id="slips-status">Loading embedded slip dataset...</p>
          <div class="scroll-list" id="slips-list"></div>
        </div>
        <div class="panel">
          <h2>Slip Context</h2>
          <p class="muted" id="slips-empty">Select a slip from the list.</p>
          <div id="slips-detail" class="hidden">
            <div class="subpanel">
              <h3>Line N-1 (Source)</h3>
              <div id="slip-prev-line" class="token-row"></div>
            </div>
            <div class="subpanel">
              <h3>Line N (Observed)</h3>
              <div id="slip-curr-line" class="token-row"></div>
            </div>
            <div class="subpanel note" id="slip-meta"></div>
          </div>
        </div>
      </div>
    </section>

    <section class="view" id="view-lattice">
      <div class="two-col">
        <div class="panel">
          <h2>Lattice Windows</h2>
          <p class="muted" id="lattice-status">Loading lattice model...</p>
          <div class="actions compact">
            <button id="lattice-reset">Reset</button>
            <button id="lattice-random">Random Window</button>
          </div>
          <div class="scroll-list" id="window-list"></div>
        </div>
        <div class="panel">
          <h2>Window <span id="lattice-window-label">0</span> Tokens</h2>
          <div id="window-words" class="word-grid"></div>
          <h3>Output Trace</h3>
          <div id="lattice-output" class="output-box"></div>
        </div>
      </div>
    </section>

    <section class="view" id="view-validator">
      <div class="panel">
        <h2>IVTFF Validator</h2>
        <p class="muted">Canonical profile: <code>ZL3b-n.txt -> EVAParser -> source_id=&quot;zandbergen_landini&quot; -> load_canonical_lines() + sanitize_token()</code></p>
        <div class="actions">
          <label>Mode
            <select id="validator-mode">
              <option value="syntax">Syntax Only</option>
              <option value="sanitized">Syntax + Sanitized Token Report</option>
              <option value="lattice">Syntax + Lattice Admissibility</option>
            </select>
          </label>
          <label><input id="validator-strict-canonical" type="checkbox" checked> Strict canonical lowercase policy</label>
          <button id="validator-validate">Validate</button>
          <button id="validator-sample">Load Sample</button>
          <button id="validator-clear">Clear</button>
        </div>
        <textarea id="validator-input" rows="14" placeholder="Paste IVTFF lines or content-only lines here..."></textarea>
      </div>
      <div class="two-col">
        <div class="panel">
          <h3>Validation Summary</h3>
          <div id="validator-summary" class="report-box muted">No validation run yet.</div>
          <h3>Line Diagnostics</h3>
          <div id="validator-lines" class="report-box"></div>
        </div>
        <div class="panel">
          <h3>Normalized Output</h3>
          <textarea id="validator-normalized" rows="12" readonly></textarea>
          <h3>Machine Metrics</h3>
          <div id="validator-machine" class="report-box muted">Not evaluated yet.</div>
        </div>
      </div>
    </section>

    <section class="view" id="view-folio">
      <div class="panel">
        <h2>Synthetic Folio Generator</h2>
        <div class="control-grid">
          <label>Seed <input id="folio-seed" type="number" value="42"></label>
          <label>Line Count <input id="folio-lines" type="number" min="1" max="200" value="9"></label>
          <label>Min Words/Line <input id="folio-min-words" type="number" min="1" max="50" value="6"></label>
          <label>Max Words/Line <input id="folio-max-words" type="number" min="1" max="60" value="12"></label>
          <label>Start Window (blank=random) <input id="folio-start-window" type="number" min="0" placeholder="auto"></label>
          <label>Folio Label <input id="folio-label" type="text" value="f1000r"></label>
          <label>Scribe Profile
            <select id="folio-profile">
              <option value="hand1">Hand 1</option>
              <option value="hand2">Hand 2</option>
            </select>
          </label>
          <label><input id="folio-canonical-filter" type="checkbox" checked> Canonical lowercase token filter</label>
          <label>Output Format
            <select id="folio-format">
              <option value="content">Content Only</option>
              <option value="ivtff">Full IVTFF Lines</option>
            </select>
          </label>
        </div>
        <div class="actions">
          <button id="folio-generate">Generate Folio</button>
          <button id="folio-generate-validate">Generate -> Validate</button>
        </div>
        <div id="folio-stats" class="report-box muted">No folio generated yet.</div>
        <textarea id="folio-output" rows="14" placeholder="Generated output appears here..." readonly></textarea>
      </div>
    </section>

    <section class="view" id="view-page">
      <div class="panel">
        <h2>Page Generator (Planned)</h2>
        <p>This capability is intentionally deferred.</p>
        <ul>
          <li>Need a validated mapping from folio id to section-level mask/state schedule.</li>
          <li>Need stable line-count and line-entry priors by folio/quire context.</li>
          <li>Need transliteration-bridge rules for source-specific rendering.</li>
        </ul>
        <p>Current recommendation: use Folio Generator for synthetic output and validate with the IVTFF Validator.</p>
      </div>
    </section>
  </main>

  <aside class="console-panel">
    <h3>Internal Console</h3>
    <div id="debug-console"></div>
  </aside>

  <script src="data/slips_data.js"></script>
  <script src="data/lattice_data.js"></script>
  <script src="data/metadata.js"></script>

  <script src="js/state.js"></script>
  <script src="js/ui_console.js"></script>
  <script src="js/router.js"></script>
  <script src="js/data_loader.js"></script>

  <script src="js/core/sanitize.js"></script>
  <script src="js/core/ivtff_parser.js"></script>
  <script src="js/core/ivtff_validator.js"></script>
  <script src="js/core/lattice_engine.js"></script>
  <script src="js/core/folio_generator.js"></script>

  <script src="js/views/slips_view.js"></script>
  <script src="js/views/lattice_view.js"></script>
  <script src="js/views/validator_view.js"></script>
  <script src="js/views/folio_generator_view.js"></script>
  <script src="js/views/page_generator_view.js"></script>

  <script src="js/app.js"></script>
</body>
</html>
